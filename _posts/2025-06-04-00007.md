---

title: "[MIT6.034] 7.시각지각과 제약 만족 문제 (Constraint Satisfaction & Waltz Algorithm)"
date: 2025-06-04 18:00:00 +0900
categories: [AI, AI-Lecture]
tags: [MIT-6.034]
math: true
---

**🧱 MIT AI 강의 7 - Constraint Satisfaction: 시각 인식에서 제약 전파 기법**

---

## 🧠 인간 시각 인식에서 출발한 문제

* **Adolfo Guzman**: 아이 블록(Ai blocks) 사진을 바탕으로, 선 그림(line drawing)에서 **객체 수를 추론**하는 프로그램 개발 시도
* 그림 안에서 **arrow junction(화살표 모양 교차점 ㄷ)**, **fork junction(포크 모양 교차점 Y)** 등을 **증거 단위(quanta of evidence)\*\*로 삼아 면들이 같은 객체에 속하는지 판단

<div style="text-align:center;">
  <figure>
    <img src="/assets/images/2025-06-04-00007-01-image.png" alt="아이 블록(Ai blocks)" width="200"/>
    <figcaption>그림 1. 아이 블록(Ai blocks)</figcaption>
  </figure>
</div>



### Guzman의 세 가지 이론

1. **1-link 이론**: 선이 하나만 공유돼도 동일 객체 판단 → 너무 느슨함 (모든 면이 연결)
2. **2-link 이론**: 선 2개 공유해야 동일 객체 → 너무 보수적 (일부 객체 누락)
3. **2-link 반복 이론**: 먼저 super region 생성 → 그 후 2개 이상 링크로 연결된 경우 병합 → 상대적 개선
  > "일단 비슷해 보이는 면들끼리 임시로 묶자. 그리고 그 중 진짜 같은 객체일 것 같은 것들만 2개 이상 연결되었는지 확인해서 확정하자" 
  - A와 B는 선 하나로 이어져 있음 → 슈퍼리전 AB
  - C는 B와 선 하나로만 이어짐 → 슈퍼리전 BC
  - 하지만 AB와 BC 사이에는 두 개 이상의 연결이 없으면 → 병합 안 함

> 🔎 단점: 여전히 **물리적 제약/일관성 부족** → **David Huffman**의 수학적 접근 등장

---

## 📐 Huffman의 이론적 모델링

---

### 🧾 전제 조건

#### 1. **일반 위치 (General Position)**

* 관찰자의 시점이 너무 특이하면 선의 형태가 왜곡되어 **정확한 판단이 어려움**
* 예: T-junction이 카메라 각도에 따라 arrow-junction처럼 보일 수 있음
* 따라서 분석 전제는:  
  → **우연하거나 예외적인 시점(특수 시점)을 제거한 일반적 뷰에서만 분석**

#### 2. **Trihedral World**

* 모든 정점(vertex)은 **정확히 3개의 면(face)**이 만나는 구조
* 즉, 물체는 박스, 블록 같은 단순 입체 구조로 간주됨
* 이 조건 덕분에 **junction(교차점)**의 유형을 **제한된 개수로 분류** 가능

#### 3. **라인 종류 (Edge Types)**

* 선(line)은 세 가지 유형 중 하나로 분류됨:

| 유형      | 기호 | 의미 |
|-----------|------|------|
| Convex    | +    | 볼록한 모서리 — 바깥으로 튀어나온 면의 경계 |
| Concave   | −    | 오목한 모서리 — 안으로 꺾여 들어간 면의 경계 |
| Boundary  | →    | 경계선 — 더 이상 면이 없는 물체의 외곽 |

---

### 🔗 Huffman Junctions: 총 18가지 가능한 junction 조합


<div style="text-align:center;">
  <figure>
    <img src="/assets/images/2025-06-04-00007-03-image.png" alt="교차점(junction)" width="400"/>
    <figcaption>그림 2. 교차점(junction)</figcaption>
  </figure>
</div>


* **Trihedral world** 전제하에 가능한 모든 교차점(junction)을 분류

| Junction 종류             | 이유                                      |
| ----------------------- | --------------------------------------- |
| **L-junction (6개)**     | 2개의 선이 만남. 가능한 **모양 + 볼록/오목 조합** 총합이 6개 |
| **Fork-junction (5개)**  | 3선이 Y자처럼 뻗음. 이 중 일부는 **대칭**이라 중복 제외     |
| **T-junction (4개)**     | 1선이 다른 2선을 가림. 가능한 방향성과 라인 타입을 고려한 4가지  |
| **Arrow-junction (3개)** | 세 선이 화살표 형태로 만남. 구조적으로 가능한 경우만 3개       |


* 이 조합은 **3개의 면이 만나는 정점**에서 생길 수 있는 모든 선 교차의 유형
* 각 junction은 **옥탄트(octant)**의 조합에 따라 유도됨

> ✅ 이 집합은 trihedral 구조의 세계에서 가능한 **완전한 junction 목록**

#### **L-junction 과 T-junction의 차이**

| 항목          | L-junction             | T-junction                     |
| ----------- | ---------------------- | ------------------------------ |
| **선의 구조**   | 두 개의 선이 만나 **"ㄴ"자 형태** | 한 선이 다른 선의 **중간을 가로막음**        |
| **표현하는 의미** | 두 개의 **면이 만나는 실제 모서리** | 하나의 면이 **다른 면을 가려서 생긴 접선**     |
| **3D 의미**   | 두 면이 실제 입체에서 만남        | 가려진 뒷면 + 가리는 앞면 → **깊이 정보 제공** |
| **예시**      | 박스의 모서리                | 박스 뒤쪽의 선이 앞 면에 가려질 때           |







---

### 🧪 테스트 예제: 구성 가능성 판단

* 예: 홈플레이트 형태의 선 드로잉이 주어졌을 때,
  → 각 선에 **Convex/Concave/Boundary** 레이블을 붙여  
  → **junction catalog에 존재하는지 확인**

* 만약 해당 junction 조합이 catalog에 없다면?
  → 📛 **현실 세계에서 존재 불가능한 도형**으로 판단

> 이 조건은 **필요조건(necessary condition)**일 뿐,  
> 모든 junction이 허용된다고 해서 반드시 **현실적인 3D 도형이 구성되는 것은 아님**  
> (즉, **충분조건은 아님**)

---


## 🧠 David Waltz의 확장: 자연 장면 처리

### 현실 문제 대응

* 그림자, 틈(crack), 비-3면(vertex), 조명 등 **복잡한 현실 요소 반영**
* Junction 수천 개, 라벨 수 50+개로 확장
* → 수작업 불가 → **자동화 탐색 및 제약 전파 필요**

### 깊이 우선 탐색(DFS)의 한계

* 수천 개 라벨, 수백 개 junction → DFS는 **계산 불능 수준의 탐색 공간**
* 해결책: **제약 전파(Constraint Propagation)**

---

## 🔁 Waltz Algorithm (제약 전파 기법)

### 절차 요약

1. 각 junction에 가능한 **모든 라벨 후보를 배정**
2. 인접 junction들과의 라인 라벨 제약을 통해 **불일치하는 후보 제거**
3. **제약이 전파**되며 다른 junction에도 후보가 제거됨
4. 후보군이 1개로 수렴될 때까지 반복 → **고정점 도달 시 해답 획득**

### 예시 전개 (Huffman 라벨 이용)

* junction 1 → 가능한 fork 3개 배정
* junction 2 → 6개 중, junction 1의 선 라벨에 맞지 않는 4개 제거
* junction 3 → junction 2의 결과 반영하여 후보 제한
* 후보 수가 1로 수렴되면 → 전체 junction 해석 완료

> 💡 핵심: 인접 노드끼리 **상호 제약을 통해 후보 수를 줄이며** 해를 찾음

---

## 🧪 모호성과 비모호 예시 비교

* 예제 1: 모호함 없음 → 고유 해 존재
* 예제 2: ambiguity 발생 → 다중 해 존재
* 예제 3: 경계선 삭제 → 하위 노드 탐색 실패 후 **역전파(backtrack)**로 실패 처리

> ✅ Waltz 알고리즘은 **현실 세계 지각 모델**로서 신경계와 유사한 방식으로 작동 가능

---

## ✅ 정리

* **Guzman**: 실험적, Heuristic 방식 → 문제 설정과 실행 가능성 제공
* **Huffman**: 이론적 수학 모델로 가능/불가능 판단 도구 정립
* **Waltz**:

  * 현실 반영 (조명, 그림자 등 포함)
  * 대규모 라벨/조합 → 제약 전파 기법 개발
* 제약 전파 알고리즘은 **시각 인식뿐 아니라 지도 색칠, 스케줄링 문제 등에도 활용 가능**
