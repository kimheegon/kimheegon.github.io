---

title: "[MIT6.034] 9.객체 인식 이론: Marr부터 Correlation까지"
date: 2025-06-04 20:00:00 +0900
categories: [AI, AI-Lecture]
tags: [MIT-6.034]
math: true
---

**🧠 MIT AI 강의 9 - 객체 인식: Marr 이론부터 Correlation 모델까지**

---

## 🎭 얼굴 변화 데모와 주제 소개

* 얼굴 조합 예시 (눈, 입, 표정, 스타일 변화)로 강의 도입
* 인간이 어떻게 객체(특히 얼굴)를 인식하는지에 대한 다양한 **이론적 접근 방식** 소개

---

## 📚 Marr의 인식 이론 (Primal Sketch → 2.5D Sketch → Generalized Cylinders)

### 처리 단계:

1. **Primal Sketch**: 엣지(edge) 검출 단계
2. **2.5D Sketch**: 표면 방향(벡터)을 포함한 깊이 정보 추정
3. **Generalized Cylinder**: 원판 단면을 따라 축을 따라 움직이며 형태 정의

   * 예: 와인 병 = 축을 따라 반지름이 줄어드는 원기둥

### 문제점:

* **표현이 너무 거칠고 구분력 부족**

  * Ford와 Chevrolet 구분 불가능
* 실질적 구현 실패

---

## 🔄 Ullman의 정렬 이론 (Alignment Theory)

> **사물을 세 시점에서 관찰한 정보만으로**,  
> **새로운 시점에서 어떻게 보일지를 예측**할 수 있다는 인식 이론  
> (under orthographic projection, 직교 투영 하에서)

---

### 🧠 핵심 아이디어

* 단 **3개의 시점**에서 동일한 객체를 관찰
* 각 시점에서 **일치하는 점(corresponding point)**을 찾음
* 수학적으로 점의 위치를 다음과 같이 표현:
  > $$x_u = \alpha x_a + \beta x_b + \gamma x_c + \tau$$
 


* 여기서:
  * $$( x_u )$$: 새로운 시점에서의 점의 x좌표
  * $$( x_a, x_b, x_c )$$: 기존 시점 A, B, C에서의 x좌표
  * $$( \alpha, \beta, \gamma, \tau )$$: 가중치 계수

---

### 🛠️ 절차

1. **3장의 시점 이미지**에서 동일한 객체의 **일치하는 점** 선택
2. 이 점들을 바탕으로 **선형 방정식 시스템** 구성
3. $$( \alpha, \beta, \gamma, \tau )$$를 추정하여 새로운 시점에서 **예측 좌표 계산**
4. 예측된 시점 이미지와 실제 관찰 이미지가 **일치하면 인식 성공**

---

### 🍷 예시

* **와인 병 인식**  
  → 축을 따라 반지름이 점점 줄어드는 **회전형 구조**  
  → 정렬 이론으로 충분히 설명 가능

---

### ⚠️ 한계점

| 문제                    | 설명 |
|-------------------------|------|
| **정확한 점 대응 필요**   | 3장의 시점에서 완벽하게 같은 점을 정확히 짚어야 함 |
| **자연물 인식에 부적합** | 얼굴, 나무, 돌 등은 표면 구조가 복잡하여 **정확 대응이 매우 어려움** |
| **실질적 구현 실패**     | Ford와 Chevrolet 같은 실제 자동차도 **구분 어려움** → 구체적 분해 불가 |

> 🧩 따라서, 단순한 기하 구조에는 유효하지만,  
> **복잡하거나 유기적인 객체**에는 **제한적인 이론**임

---

### ✅ 결론 요약

* Ullman은 **적은 시점 정보로도 인식이 가능하다는 계산 모델**을 제시함
* 그러나, 이 이론은 **정밀한 점 대응**이 핵심이므로  
  **실제 환경에서는 적용이 어려운 경우가 많음**

---

## 🔍 Correlation 기반 인식 (Intermediate Features)

### 전체 얼굴 ➡️ 실패:

* 다른 사람들과 너무 다르면 찾기 쉬우나, **일반화 불가**
* 예: $$\ne$$ 조지 워싱턴 얼굴을 가진 사람은 거의 없음

### 단일 특성 (눈 등) ➡️ 실패:

* **문 손잡이에서도 눈이 탐지됨** (특징 과소 정의)

### 🌟 적당한 크기의 중간 특징 ➡️ 성공:

* **Goldilocks Principle** 적용:

  * 너무 크지도, 작지도 않은 특징
  * 예: **두 눈 + 코**, **입 + 코** 조합 등

---

## 📈 수학적 정의: Correlation 수식
> 하나의 신호/이미지 안에서 **특정 패턴(template)**이 어디에 잘 맞는지를 이동시키면서 점검하는 연산.

### 🧩 "고정된 마스크"란?

* 마스크란 내가 **찾고자 하는 대상**의 특징 패턴입니다.
  - 예: Erica 얼굴의 눈·코·입 위치를 담은 템플릿

    | 상황            | 내가 찾는 것 (마스크) |
    | ------------- | ------------- |
    | 이미지에서 얼굴 찾기   | 얼굴 모양 템플릿     |
    | 오디오에서 "hi" 인식 | "hi"의 파형 모양   |
    | 손글씨에서 "5" 찾기  | 숫자 5의 형태      |

* 이 마스크는 **형태가 변하지 않음** → 고정
* 대신 전체 신호 또는 이미지를 **이리저리 움직이며 겹쳐봄**

  | 상황     | 입력 데이터                   |
  | ------ | ------------------------ |
  | 전체 이미지 | 사람 얼굴이 있을 수도 있고 없을 수도 있음 |
  | 오디오 파일 | 말, 음악, 잡음 등 섞여 있음        |
  | 손글씨 사진 | 0부터 9까지 다양한 숫자들이 섞여 있음   |



**"두 벡터의 내적(dot product)이 크면, 방향이 비슷하다"**

두 함수 $$f(x), g(x)$$가 있다고 할 때,  
이 둘의 유사도를 나타내는 수학적 표현은 다음과 같습니다:

$$
\int f(x) \cdot g(x) \, dx
$$

### 1D 버전:

$$
\max_t \int f(x)g(x - t)dx
$$

| 기호         | 의미                              |
| ---------- | ------------------------------- |
| $f(x)$     | 패턴 (예: 얼굴 마스크)                  |
| $g(x)$     | 전체 신호 (예: 이미지 한 줄)              |
| $t$        | **이동량(translation)** → 어디에 맞춰볼지 |
| $g(x - t)$ | 신호를 $t$만큼 오른쪽으로 이동시킨 것          |



### 2D 이미지 버전:

$$
\max_{x_0,y_0} \int \int f(x,y)g(x - x_0, y - y_0) dx dy
$$

* $f$: 얼굴 마스크, $g$: 전체 이미지
* Translation ($x, y$ offset) 통해 유사도 탐색

| 기호                    | 의미                         |
| --------------------- | -------------------------- |
| $f(x, y)$             | 2D 패턴 (예: 얼굴 마스크)          |
| $g(x, y)$             | 전체 이미지                     |
| $x_0, y_0$            | 이미지 상에서의 이동량 (translation) |
| $g(x - x_0, y - y_0)$ | 전체 이미지에서 마스크를 해당 위치로 옮긴 것  |



### 효과:

* **노이즈에 강함**, 패턴 매칭 정교함
* 실제 데모에서 Erica/Nicola 얼굴 탐지 가능

---

## 🧪 Upside-down 얼굴 효과

* 얼굴을 거꾸로 하면 인식 정확도 급감
* 이유: **세로 방향 특징의 일치성 상실 → Correlation 약화**

---

## 🎬 영상 이해와 이야기

### 실험 예시:

* 사람이 컵을 입으로 가져가는 동작
* 고양이가 물을 마시는 GIF

### 인식 결과:

* 두 영상은 시각적으로 다르지만 **“drinking(마시기)”라는 동일한 의미**로 인식

> 🔑 **스토리 기반 이해**: 인간은 시각 장면을 단순히 픽셀 매칭이 아니라, **의미 있는 이야기로 해석**함

---

## ✅ 정리

* 초기 이론들 (Marr, Ullman)은 **구조 기반(feature-based)** 인식 접근
* 이후 이론 (Correlation)은 **유사도 기반** 접근
* 얼굴 인식은 단일 점이나 전체 형태보다 **중간 수준 특징 조합**이 효과적
* 최종적으로, 인간 인식은 **시각 정보 + 이야기 해석의 융합**
* 👉 객체 인식의 현재 과제: 정면 외의 시점, 스케일, 회전 변화에도 강인한 인식 모델 만들기
